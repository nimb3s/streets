version: "3.9"
services:
    api:
        container_name: Streets.Api
        build:
          context: .
          dockerfile: Dockerfile
        ports:
            - "5000:80"
        depends_on:
            - db
    db:
        container_name: Streets.Database
        build:
          context: .
          dockerfile: src/Nimb3s.Streets.Database/Dockerfile

        environment:
            SA_PASSWORD: "1234qwerASDF"
            ACCEPT_EULA: "Y"
            MSSQL_PID: Express
        ports:
            - "31433:1433"

#docker build -f "C:\git\streets\src\Nimb3s.Streets.Database\Dockerfile" -t nimb3s/streets --force-rm --label "com.microsoft.created-by=visual-studio" --label "com.microsoft.visual-studio.project-name=Nimb3s.Streets.Database" "C:\git\streets" --progress plain --no-cache
#docker-compose build --no-cache --progress plain --pull
#docker build -f "C:\git\streets\src\Nimb3s.Streets.Api\Dockerfile" -t nimb3s/streets.api --force-rm --label "com.microsoft.created-by=visual-studio" --label "com.microsoft.visual-studio.project-name=Nimb3s.Streets.Api" "C:\git\streets" --progress plain --no-cache
#docker build --target componenttestrunner -f "C:\git\streets\src\Nimb3s.Streets.Api\Dockerfile" -t nimb3s/streets.api --force-rm --label "com.microsoft.created-by=visual-studio" --label "com.microsoft.visual-studio.project-name=Nimb3s.Streets.Api" "C:\git\streets" --progress plain --no-cache


#docker build --no-cache --progress plain -t nimb3s-streets-api:latest .
#docker build --target componenttestrunner -t nimb3s-streets-component-tests:latest .
#docker build --target e2etestrunner -t nimb3s-streets-e2e-tests:latest .
#docker-compose up --detach

#docker pull mcr.microsoft.com/playwright:v1.10.0-focal
#docker run -it --rm --ipc=host mcr.microsoft.com/playwright:focal /bin/bash

#docker run --network=host nimb3s-streets-component-tests:latest
#docker run --network=host nimb3s-streets-e2e-tests:latest
#docker-compose stop
#docker-compose rm --force
